<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>TFG - Dashboard IoT</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-4">

    <h1 class="text-center mb-4">📡 TFG - IoT Dashboard</h1>

    <div class="text-center mb-3">
        <a href="/?modo=real" class="btn btn-success me-2">Mostrar solo Reales ✅</a>
        <a href="/?modo=infectado" class="btn btn-danger me-2">Mostrar solo Infectados ❌</a>
        <a href="/?modo=todo" class="btn btn-secondary">Mostrar Todos 🔁</a>
    </div>

    <p class="text-center text-muted">Modo actual: <strong>{{ modo }}</strong></p>

    <div class="row g-4 justify-content-center">
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">📈 Humedad (%)</h5>
                    <canvas id="humidityChart" height="300"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">🌡️ Temperatura (°C)</h5>
                    <canvas id="temperatureChart" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>
    <p><a href="{{ url_for('user_bp.logout') }}">Cerrar sesión</a></p>
    <p>¿Quieres crearte un usuario? <a href="{{ url_for('user_bp.registro') }}">Regístrate aquí</a></p>
</div>

<script>
    const labels = {{ ids | tojson }};
    const temperatureData = {{ temperature | tojson }};
    const humidityData = {{ humidity | tojson }};

    new Chart(document.getElementById('humidityChart'), {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Humedad (%)',
                data: humidityData,
                borderColor: 'green',
                fill: false,
                tension: 0.1
            }]
        },
        options: {
            responsive: true
        }
    });

    new Chart(document.getElementById('temperatureChart'), {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Temperatura (°C)',
                data: temperatureData,
                borderColor: 'red',
                fill: false,
                tension: 0.1
            }]
        },
        options: {
            responsive: true
        }
    });
</script>

</body>
</html>
